const API_URL="http://localhost:5000/api/docs";const token=localStorage.getItem("token");if(!token)window.location="login.html";const tableBody=document.querySelector("#docsTable tbody");const search=document.getElementById("search");async function loadDocs(query=""){const url=query?`${API_URL}/list?q=${query}`:`${API_URL}/list`;const res=await fetch(url,{headers:{Authorization:`Bearer ${token}`}});const docs=await res.json();tableBody.innerHTML="";docs.forEach(d=>{const row=document.createElement("tr");row.innerHTML=`<td>${d.originalName}</td><td>${(d.size/1024).toFixed(1)} KB</td><td>${new Date(d.uploadDate).toLocaleString()}</td><td><a class="btn" href="http://localhost:5000/api/docs/download/${d._id}?token=${token}" target="_blank">Download</a><button class="btn delete" onclick="deleteDoc('${d._id}')">Delete</button></td>`;tableBody.appendChild(row)})}async function deleteDoc(id){await fetch(`${API_URL}/delete/${id}`,{method:"DELETE",headers:{Authorization:`Bearer ${token}`}});loadDocs()}search.addEventListener("input",()=>loadDocs(search.value));function logout(){localStorage.removeItem("token");window.location="login.html"}loadDocs();